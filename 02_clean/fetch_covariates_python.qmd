
```{python}
import pandas as pd
import requests
import numpy as np

import json
import pandas.io.json 
from pyprojroot.here import here
```

```{python}
# constants
appid = "12604ebf628834b46b3867721893644141fe9a34"
url = "http://api.e-stat.go.jp/rest/3.0/app/json/getStatsData"
```

```{python}
# functions
def show_data_info(appid, stats_data_id):

    params = {
    "appId": appid,
    "statsDataId": stats_data_id,
    "lvArea": 1,
    "limit": 2, 
    "lang": "J"
    }

    data_json = requests.get(url, params=params).json()

    return data_json['GET_STATS_DATA']['STATISTICAL_DATA']['CLASS_INF']['CLASS_OBJ']


def get_data(appid, stats_data_id, cat1 = None, cat2 = None, cat3 = None, cat4 = None, cat5 = None, cat6 = None):

    params = {
        "appId": appid,
        "statsDataId": stats_data_id,
        "lang": "J",
        "cdCat01": cat1,
        "cdCat02": cat2,
        "cdCat03": cat3,
        "cdCat04": cat4,
        "cdCat05": cat5,
        "cdCat06": cat6
    }

    params = {k: v for k, v in params.items() if v != None}

    data_json = requests.get(url, params=params).json()

    df_output = pd.DataFrame(data_json['GET_STATS_DATA']['STATISTICAL_DATA']['DATA_INF']['VALUE'])

    return df_output

```

```{python}
# 1995_a; 0000032370
# 1995_b; 0000032372
# 2000;   0000033142
# 2005;   0000033948
# 2010;   0003052121


# 全域・集中の別; 総数
# 従業上の地位  ; 総数
# 男女         ; 総数
# 産業大分類    ; 総数
# 配偶関係　　　; 総数


# 1995_a;
show_data_info(appid, "0000032370")
df_1995_a = get_data(appid, "0000032370", cat1="00700", cat2="000", cat3="515", cat4="002")
df_1995_a.to_csv(here("01_data/raw/worker/1995_a.csv"), index=False, encoding="cp932")

# 1995_b;
show_data_info(appid, "0000032372")
df_1995_b = get_data(appid, "0000032372", cat1="00700", cat2="000", cat3="000", cat4="002")
df_1995_b.to_csv(here("01_data/raw/worker/1995_b.csv"), index=False, encoding="cp932")

# 2000;
show_data_info(appid, "0000033134")
df_2000 = get_data(appid, "0000033134", cat1="00700", cat2="000", cat3="000", cat4="000", cat5="000", cat6="002")
df_2000.to_csv(here("01_data/raw/worker/2000.csv"), index=False, encoding="cp932")

# 2005;
show_data_info(appid, "0000033948")
df_2005 = get_data(appid, "0000033948", cat1="00700", cat2="000", cat3="000", cat4="515", cat5='002')
df_2005.to_csv(here("01_data/raw/worker/2005.csv"), index=False, encoding="cp932")

# 2010;
show_data_info(appid, "0003052121")
df_2010 = get_data(appid, "0003052121", cat1="00710", cat2="002", cat3="000", cat4="000")
df_2010.to_csv(here("01_data/raw/worker/2010.csv"), index=False, encoding="cp932")


```